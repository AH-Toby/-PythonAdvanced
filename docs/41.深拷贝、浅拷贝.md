# 深拷贝|浅拷贝

## 一.变量的含义

变量是一种用于存储数据的标识符，它指向内存中存储的值

```python
a = 10
```

这个变量的意义是什么呢？？ 

**有一个变量a引用存储10的空间地址**

> 注意：
>
> 32位的操作系统的int长度为4个字节，最大的内存只能够有4g,也就是最大数值为：2<sup>32</sup>
>
> 64位为8个字节:最大数值也就是2<sup>64</sup>

### 1.变量可变类型

在Python中，有一些数据类型是可变的，这意味着可以在不创建新对象的情况下修改它们的值。

**列表(List):** 列表是Python中最常见的可变数据类型之一。它们用方括号 `[]` 表示，可以包含多个元素，允许对元素进行增加、删除和修改操作。

**字典(Dictionary):** 字典是一种键-值对的数据结构，用花括号 `{}` 表示。它们允许通过键来访问、添加和删除值。

**集合(Set):** 集合是一种无序的、唯一元素的数据结构，用花括号 `{}` 表示。集合支持添加和删除元素，以及集合运算（如并集、交集、差集等）。

**自定义对象:** 您还可以创建自定义的类对象，并使其具有可变性，以允许修改对象的属性和状态。

> 注意：
>
> 这些可变数据类型在程序中非常有用，因为它们允许对数据进行动态操作和修改。
>
> 但需要注意，可变数据类型的修改会影响原始对象，因此在处理多线程和并发编程时需要小心确保数据一致性。

### 2.变量不可变类型

在Python中，有一些数据类型是不可变的，这意味着一旦创建了这些对象，它们的值不能被修改，而任何修改操作都会创建一个新的对象。

**整数(Integer):** 整数是不可变的，一旦创建，其值不能被修改。

**浮点数(Float):** 浮点数也是不可变的，类似于整数。

**字符串(String):** 字符串是不可变的，一旦创建，其内容不能被修改。但可以通过创建新的字符串来进行字符串操作。

**元组(Tuple):** 元组是不可变的有序序列，一旦创建，其元素不能被修改。

**不可变集合(Frozen Set):** 不可变集合是一种不可变的集合数据类型，一旦创建，其内容不能被修改。

**布尔值(Boolean):** 布尔值是不可变的，只有两个可能的值：True和False。

**数值(Number):** 整数、浮点数和复数都是不可变的数值类型。

> 注意：
> 这些不可变数据类型在Python中用于表示具有固定值的数据，并且在进行操作时不会更改原始数据。
>
> 虽然它们不支持修改，但可以进行许多不可变数据类型的操作和运算，例如字符串拼接、数值运算等。
>
> 不可变数据类型通常用于确保数据的完整性和安全性。

## 二.什么是深拷贝|浅拷贝？

**深拷贝:** 拷贝的程度深，自己新开辟了一块内存，将被拷贝内容全部拷贝过来了；

**浅拷贝:** 拷贝的程度浅，只拷贝原数据的首地址，然后通过原数据的首地址，去获取内容。

**两者的优缺点对比：**

1.深拷贝拷贝程度高，将原数据复制到新的内存空间中。改变拷贝后的内容不影响原数据内容。但是深拷贝耗时长，且占用内存空间。

2.浅拷贝拷贝程度低，只复制原数据的地址。其实是将副本的地址指向原数据地址。修改副本内容，是通过当前地址指向原数据地址，去修改。所以修改副本内容会影响到原数据内容。但是浅拷贝耗时短，占用内存空间少。

## 三.浅拷贝

浅拷贝是对于一个对象的顶层拷贝，浅拷贝创建一个新的对象，但该对象只复制了原始对象中的引用，而不是其中包含的对象本身。这意味着新对象与原始对象共享内部的子对象（如果有的话）。浅拷贝通常是一种较快和较节省内存的方式，因为它不会复制整个对象的内容，而只是创建新对象的引用。

通俗的理解：拷贝了引用，没有拷贝内容

demo:

```python
import copy

original_list = [1, [2, 3], 4]
shallow_copy = copy.copy(original_list)
```

## 四.深拷贝

深拷贝创建一个新的对象，同时递归复制原始对象中的所有子对象，包括子对象的子对象，以确保新对象是完全独立于原始对象的，没有共享的部分。深拷贝通常用于需要完全复制整个数据结构的情况，以确保原始对象和复制对象之间没有任何关联。

深拷贝是对于一个对象所有层次的拷贝(递归)

demo:

```python
import copy

original_list = [1, [2, 3], 4]
deep_copy = copy.deepcopy(original_list)                                                                                           
```

## 五.copy()研究

### 1.可变类型

对于可变类型copy也会产生一个新的对象    

```python
import copy


# 可变对象研究
def deep_copy():
    a = [1, 2]
    b = a
    c = copy.deepcopy(a)
    print("地址---------------")
    print(id(a))
    print(id(b))
    print(id(c))
    print("值---------------")
    print(a)
    print(b)
    print(c)
    a.append(3)
    print("添加3后的值---------------")
    print(a)
    print(b)
    print(c)


def shallow_copy():
    a = [1, 2]
    b = a
    c = copy.copy(a)
    print("地址---------------")
    print(id(a))
    print(id(b))
    print(id(c))
    print("值---------------")
    print(a)
    print(b)
    print(c)
    a.append(3)
    print("添加3后的值---------------")
    print(a)
    print(b)
    print(c)


deep_copy()
print("-----" * 30)
shallow_copy()                       
```

### 2.外层可变内层也可变

**结构：**

`[[],[]]`

demo:

```python
import copy


# 可变对象研究
def deep_copy_list():
    a = [[1, 2], 3]
    b = copy.deepcopy(a)
    print("地址---------------")
    print(id(a))
    print(id(b))
    print("值---------------")
    print(a)
    print(b)
    a[0].append(3)
    print("内侧添加3后的值---------------")
    print(a)
    print(b)  # 深拷贝拷贝全部


def shallow_copy_list():
    a = [[1, 2], 3]
    b = copy.copy(a)
    print("地址---------------")
    print(id(a))
    print(id(b))
    print("值---------------")
    print(a)
    print(b)
    a[0].append(3)
    print("内侧添加3后的值---------------")
    print(a)
    print(b)  # 浅拷贝拷贝只拷贝最外侧引用


deep_copy_list()
print("-----" * 30)
shallow_copy_list()
```

### 3..外层不可变内层可变

**结构：**

`([],[])`

demo:

```
import copy


# 外层不可变对内层可变对象研究
def deep_copy():
    a = ([1, 2], 3)
    b = copy.deepcopy(a)
    print("地址---------------")
    print(id(a))
    print(id(b))
    print("值---------------")
    print(a)
    print(b)
    a[0].append(3)
    print("内侧添加3后的值---------------")
    print(a)
    print(b)  # 深拷贝拷贝全部


def shallow_copy():
    a = ([1, 2], 3)
    b = copy.copy(a)
    print("地址---------------")
    print(id(a))
    print(id(b))
    print("值---------------")
    print(a)
    print(b)
    a[0].append(3)
    print("内侧添加3后的值---------------")
    print(a)
    print(b)  # 浅拷贝拷贝只拷贝最外侧引用


deep_copy()
print("-----" * 30)
shallow_copy()
```

### 4.对于不可变类型

不可变类型直接添加引用 

**结构：**

`((),())`

demo:

```
import copy


# 内外层不可变对象研究
def deep_copy():
    a = ((1, 2), 3)
    b = copy.deepcopy(a)
    print("地址---------------")
    print(id(a))
    print(id(b))


def shallow_copy():
    a = ((1, 2), 3)
    b = copy.copy(a)
    print("地址---------------")
    print(id(a))
    print(id(b))


deep_copy()
print("-----" * 30)
shallow_copy()
```

> 注意点:
>
> 浅拷贝对不可变类型和可变类型的copy不同
>
> copy.copy对于可变类型，会进行浅拷贝
>
> copy.copy对于不可变类型，不会拷贝，仅仅是指向

## 六.拷贝的其他方式

* 分片表达式可以赋值一个序列

demo:

```
....
In [9]: import copy
....                                                                  

In [86]: a = [11,22]                                                                 

In [87]: b  = [33,44]                                                                

In [88]: c = [a,b]                                                                   

In [89]: d = c[:]                                                                    

In [90]: c                                                                           
Out[90]: [[11, 22], [33, 44]]

In [91]: d                                                                           
Out[91]: [[11, 22], [33, 44]]

In [92]: id(c)                                                                       
Out[92]: 140242596217984

In [93]: id(d)                                                                       
Out[93]: 140242596481536

In [94]: a.append(55)                                                                

In [95]: c                                                                           
Out[95]: [[11, 22, 55], [33, 44]]

In [96]: d                                                                           
Out[96]: [[11, 22, 55], [33, 44]]

In [97]: # d = c[:] 与d = copy.copy(c)一样属于浅拷贝      
```

- 字典的copy方法可以拷贝一个字典

demo：

```
....
In [9]: import copy
....

In [98]: d = dict(name="lisi",age=18)                                                

In [99]: co = d.copy()                                                               

In [100]: id(d)                                                                      
Out[100]: 140242669460672

In [101]: id(co)                                                                     
Out[101]: 140242669762176

In [102]: d                                                                          
Out[102]: {'name': 'lisi', 'age': 18}

In [103]: co                                                                         
Out[103]: {'name': 'lisi', 'age': 18}

In [104]: d = dict(name="lisi",age=18,height_weight=[180,60])                        

In [105]: co = d.copy()                                                              

In [106]: d["height_weight"].append(70)                                              

In [107]: d                                                                          
Out[107]: {'name': 'lisi', 'age': 18, 'height_weight': [180, 60, 70]}

In [108]: co                                                                         
Out[108]: {'name': 'lisi', 'age': 18, 'height_weight': [180, 60, 70]}

In [109]: # 字典的拷贝与copy方法一样属于浅拷贝     
```

## 七.总结

**可变类型：**

1. 最外层是可变类型：`[[][]]`一定会产生新的地址，copy是浅拷贝，内层会拷贝引用，deepcopy是深拷贝，会将内层的对象拷贝一份全新的
2. 外层是不可变类型内层可变`([],[])`copy是指向，deepcopy是深拷贝

**不可变类型：**

`(()())`copy和deepcopy对于一个全部都是不可变类型进行数据拷贝的时候，那么他们的结果相同，都是引用指向



